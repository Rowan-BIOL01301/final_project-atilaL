---
title: "Final Project"
subtitle: "Data Science for Biologists, Spring 2021"
author: "Lalita Martin"
output: 
  html_document: 
    theme: cosmo
    highlight: pygments
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DON'T CHANGE THE NEXT LINE, except to add NEW options if you have any.
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = TRUE, include = TRUE)

# Load all libraries you use HERE:
library(tidyverse)
library(dplyr)
```

<br><br>

## Introduction

```{r read-examine-data}
#set file path
parks_file <- file.path("martin_parks.csv")
species_file <- file.path("martin_species.csv")
#read in datasets
parks <-read_csv(parks_file)
species <- read_csv(species_file)
#glimpse parks and species datasets
glimpse(parks)
glimpse(species)
```

<br><br>

## Question 1

#### Which state has the largest (in acres) state park? 

### Methods

```{r methods1}
parks %>% 
  #separate(State, into = c("state", "shared_state"), sep = ",") %>%
  group_by(State) %>%
  arrange(-Acres) -> parks_clean
  
#Lets take some parks to compare
#random_parks <- c("WRST", "EVER", "DEVA", "OLYM", "GRTE")
parks_clean %>%
  filter(Acres > 1000000) -> big_parks

```

### Answer

```{r answer1}
ggplot(big_parks)+
  aes(x = State, y = Acres, fill = State)+
  scale_y_log10()+
  geom_col()+
  labs(title = "National Park Acreage Per State")+
  theme_grey()
```

Arkansas comes in first with Wrangell - St. Elias National Park and Preserve at a whopping 8,323,148 acres! 


<br><br>

## Question 2

#### Which parks have the most fungi species growing in them?

### Methods

```{r methods2}
species %>%
  #rename(species, "park_name" = `Park Name`) %>%
  filter(Category == "Fungi") %>%
  filter(Occurrence == "Present") %>%
  count(`Park Name`) %>%
  filter(n > 200) %>%
  arrange(-n) -> fun_guy

```

### Answer

``` {r answer2}
ggplot(fun_guy)+
  aes(y = reorder(`Park Name`, n), x = n, fill = `Park Name`)+
  geom_col()+
  theme_grey()+
  theme(legend.position = "none")+
  labs(title = "Number of Fungi Species in Parks", 
       x = "Number of Species Found", 
       y = "Park Name")

```

Shenandoah National Park has the most species of fungi, followed by Great Smoky Mountains, North Cascades National Park, and three others all with more than 200 species found! 

<br><br>

## Question 3

#### Which parks have high amounts of algae species found? 

### Methods

```{r methods3}
species %>%
  #rename(species, "park_name" = `Park Name`) %>%
  filter(Category == "Algae") %>%
  filter(Occurrence == "Present") %>%
  count(`Park Name`) %>%
  filter(n > 50) %>%
  arrange(-n) -> gee_al

```

### Answer

```{r answer3}
ggplot(gee_al)+
  aes(y = reorder(`Park Name`, n), x = n, fill = `Park Name`)+
  geom_col()+
  theme_grey()+
  theme(legend.position = "none")+
  labs(title = "Number of Algae Species in Parks", 
       x = "Number of Species Found",  
       y = "Park Name")

```

Not very many parks have algae species at all in them. However there were seven, of which I have included the top 4 that had greater than 50, because the bottom two were less than 30. 


<br><br>

## Question 4

#### REPLACE TEXT WITH YOUR QUESTION. Your question should literally be a level-4 header.

### Methods

```{r methods4}
species %>%
  filter(Category == "Vascular Plant") -> plants

```

### Answer

```{r answer4}


```

Replace this text with your answer to your question.
